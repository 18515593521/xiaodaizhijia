<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>供应商管理</title>
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <meta name="author" content="Amee" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <link rel="stylesheet" href="../css/bootstrap.min.css" />
    <link rel="stylesheet" href="../css/font-awesome.min.css" />
    <link rel="stylesheet" href="../css/ace.min.css" />
    <link rel="stylesheet" href="../css/ace-rtl.min.css" />
    <link rel="stylesheet" href="../css/admin.css" />
    <!--[if IE 7]>
	<link rel="stylesheet" href="../css/font-awesome-ie7.min.css"/>
	<![endif]-->
    <!--[if lte IE 8]>
	<link rel="stylesheet" href="../css/ace-ie.min.css"/>
	<![endif]-->
    <!--[if lt IE 9]>
	<script src="../js/html5shiv.js"></script>
	<script src="../js/respond.min.js"></script>
	<![endif]-->
    <script src="../js/ace-extra.min.js"></script>
</head>

<body class="skin-3 bg-fff scrolling">
    <div class="breadcrumbs " id="breadcrumbs">
        <ul class="breadcrumb">
            <li>
                <i class="icon-home home-icon"></i>
                首页
            </li>
            <li>
                供应商管理
            </li>
        </ul>
       
    </div>
    <div class="page-content">
        <div class="row">
            <div class="col-sm-12">
                <form action="/supermarket/back/supplier/find_supplier" class="form-horizontal" role="form" method="post">
                    <div class="form-group  col-sm-6 col-lg-4 ">
                        <label class="col-sm-3 control-label no-padding-right"> 公司名称 </label>
                        <div class="col-sm-9">
                            <input type="text" id ="ci_name" placeholder="" class="input-large" name="ci_name" />
                        </div>
                    </div>
                    <div class="form-group  col-sm-6  col-lg-4 ">
                        <label class="col-sm-3 control-label no-padding-right"> 联系人 </label>
                        <div class="col-sm-9">
                            <input type="text" id ="ci_username" placeholder="" class="input-large" name="ci_username" />
                        </div>
                    </div>
                    <div class="form-group  col-sm-6  col-lg-4 ">
                        <label class="col-sm-3 control-label no-padding-right"> 对接人</label>
                        <div class="col-sm-9 am-select">
                            <select class="" id="pass" name="state">
                                <option value="">=======&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;请选择&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=======</option>
                               	<#list listrole as role>                             	 
                               		<option value="${role.sys_sa_id}">${role.sys_sa_name}</option>
								</#list>
                              
                            </select>
                        </div>
                    </div>
                    <div class="form-group  col-sm-12 center">
                        <a href="#modal" role="button" data-sign="1" data-toggle="modal" class="btn btn-xs btn-primary" onclick="clickbtnGet(this)">
                            新增
                        </a>
                        <button type="submit" class="btn btn-xs btn-success">
                            搜索
                            <i class="icon-arrow-right icon-on-right bigger-110"></i>
                        </button>
                    </div>
                </form>
            </div>
            <div class="col-sm-12 w100">
                <div class="table-responsive">
                    <table id="table" class="table table-striped table-bordered table-hover">
                        <thead>
                            <tr>
                                <th>序号</th>
                                <th>公司名称</th>
                                <th>联系人</th>
                                <th>联系电话</th>
                                <th>公司地址</th>
                                <th>对接人</th>
                                <th>上线日期</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
	                        <#list listsupplier as supplier>                             	 
	                              <tr>
	                                <td>${supplier_index+1}</td>
	                                <td>${supplier.ci_name}</td>
	                                <td>${supplier.ci_username}</td>
	                                <td>${supplier.ci_userphone}</td>
	                                <td>${supplier.ci_address}</td>                          
	                                <td>${supplier.sys_sa_name!''}</td>
	                                <td>${supplier.create_time}</td>
	                                <td>
	                                    <a href="#modal" data-sign="0" data-id="${supplier.ci_id}"  role="button" data-toggle="modal" class="btn btn-xs btn-success" onclick="clickbtnGet(this)">
	                                        修改</a>
	
	                                    <button class="btn btn-xs btn-danger" value="${supplier.ci_id}" onclick="clickbtnDel(this.value)">
	                                        删除</button>
	                                </td>
	                           	 </tr> 		
							</#list>
                            
                        </tbody>
                    </table>
                </div>

            </div>
        </div>
        <a href="#" id="btn-scroll-up" class="btn-scroll-up btn btn-sm btn-inverse">
            <i class="icon-double-angle-up icon-only bigger-110"></i>
        </a>
    </div>
    <div id="modal" class="modal fade">
        <div class="modal-dialog " style="width: 80%" style="margin-top: 200px">
            <div class="modal-content">
                <div class="modal-header no-padding">
                    <div class="table-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                            <span>&times;</span>
                        </button>
                        添加数据
                    </div>
                </div>
                <div class="modal-body">
                    <div class="row mt-10 form-horizontal ">
                        <div class="form-group col-xs-12">
                            <label class="col-sm-3 control-label no-padding-right">公司名称</label>
                            <div class="col-sm-9">
                                <input type="text" id="name" placeholder="" class="input-large" name="" />
                            </div>
                        </div>
                        <input type="hidden" value="" id="sid">
                        <div class="form-group col-xs-12">
                            <label class="col-sm-3 control-label no-padding-right">联系人</label>
                            <div class="col-sm-9">
                                <input type="text" id="username" placeholder="" class="input-large" name="" />
                            </div>
                        </div>
                        <div class="form-group col-xs-12">
                            <label class="col-sm-3 control-label no-padding-right">联系电话</label>
                            <div class="col-sm-9">
                                <input type="text" id="ci_userphone" placeholder="" class="input-large" name="" />
                            </div>
                        </div>
                        <div class="form-group col-xs-12">
                            <label class="col-sm-3 control-label no-padding-right">公司地址</label>
                            <div class="col-sm-9">
                                <input type="text" id="ci_address" placeholder="" class="input-large" name="" />
                            </div>
                        </div>
                        <div class="form-group  col-xs-12">
                            <label class="col-sm-3 control-label no-padding-right"> 对接人</label>
                            <div class="col-sm-9 am-select">
                                <select class=""  id="pass1" name="state">
                                    <option value="0">=======&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;请选择&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=======</option>
                                    <#list listrole as role>                             	 
                               			<option value="${role.sys_sa_id}">${role.sys_sa_name}</option>
									</#list>                                 
                                </select>
                            </div>
                        </div>
                        <div class="form-group col-xs-12">
                            <label class="col-sm-3 control-label no-padding-right">时间</label>
                            <div class="col-sm-9">
                                <div class="pos-rel">
                                    <div class="input-group">
                                        <span class="input-group-addon">
                                            <i class="icon-calendar"></i>
                                        </span>
                                        <input class=" date-picker" id="selectDate" type="text" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer no-margin-top">
                    <div class="col-sm-12 center">
                        <button class="btn btn-xs btn-success" data-dismiss="modal" onclick="clickbtnSaveUpdate()">
                            确定
                        </button>
                        <button class="btn btn-xs btn-danger" data-dismiss="modal">取消
                        </button>
                    </div>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
    <script src="../js/laydate/laydate.js"></script>
    <script src="../js/jquery-2.0.3.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script type="text/javascript">
        laydate.render({
            elem: '#selectDate'
        });
        $(function () {
            var flag = false;
            $("#close").click(function () {
                flag = !flag;
                $(this).text(flag ? '查看' : '收起');
                $("#table")[flag ? "hide" : "show"]()
            })
        })
        
       function clickbtnGet(btn){
     		var btn = $(btn);
    		var sign = btn.data('sign'); 
    		var ci_id = btn.data('id');
    		
	   		if(sign=="0"){
	   			$('.table-header').html("修改供应商");
	   			findByIdSupplier(ci_id);
	   		}else{
	   			$('.table-header').html("添加管理员");	 
		   		$("#sid").val("");
	  		    $("#name").val("");
	  		    $("#username").val("");
	  		    $("#ci_userphone").val("");
	  		    $("#ci_address").val("");
	  		 	$("#selectDate").val("");
	  		 	$("#pass1").find("option[value='0']").attr("selected",true);
	   		}
	       	 
        }
        
        function clickbtnSaveUpdate(){	
        	var ci_id = $("#sid").val();
       		var ci_name = $("#name").val();
       		var ci_username = $("#username").val();
       		var ci_userphone = $("#ci_userphone").val();
       		var ci_address = $("#ci_address").val();
       		var sys_sa_id = $("#pass1").val();
       		var create_time = $("#selectDate").val();
       		
       		if(ci_name==""){
       			alert("请输入公司名称！");
       			return false;
       		}
       		if(ci_username==""){
       			alert("请输入联系人！");
       			return false;
       		}
       		if(ci_userphone==""){
       			alert("请输入联系电话！");
       			return false;
       		}
       		if(ci_address==""){
       			alert("请输入公司地址！");
       			return false;
       		}
       		if(ci_address==0){
       			alert("请选择对接人！");
       			return false;
       		}
       		if(create_time==""){
       			alert("时间不能为空！");
       			return false;
       		}
       		
	       		   $.ajax({
	  	      		url:"/supermarket/back/supplier/save_supplier",
	  	      		dataType:"json",
	  	      		type:"post",
	  	      		data:{ci_name:ci_name,ci_username:ci_username,ci_userphone:ci_userphone,ci_address:ci_address,
	  	      			sys_sa_id:sys_sa_id,create_time:create_time,ci_id:ci_id},
	  	      		
	  	      		success:function(data){
	  	      			window.location.reload();
	  	      		}
	  		    })   
       	
        }
        
        function clickbtnDel(ci_id){
        	if(confirm("确定删除么?")){
        		$.ajax({
     	      		url:"/supermarket/back/supplier/del_supplier",
     	      		dataType:"json",
     	      		type:"post",
     	      		data:{ci_id:ci_id},
     	      		
     	      		success:function(data){
     	      			window.location.reload();
     	      		}
     		    })  
        	}
        	 
        }
        
        function findByIdSupplier(ci_id){
        	 $.ajax({
	               url:"/supermarket/back/supplier/findByIdSupplier",
	               type:"POST",
	               dataType:"json",
	               data:{ci_id:ci_id},
	               success:function(data){
	            	   var su=data.list; 
	            	   for(i=0;i<su.length;i++){ 
	            		   
	            		   $("#sid").val(su[i].ci_id);
	            		   $("#name").val(su[i].ci_name);
	            		   $("#username").val(su[i].ci_username);
	            		   $("#ci_userphone").val(su[i].ci_userphone);
	            		   $("#ci_address").val(su[i].ci_address);
	            		   $("#pass1").find("option[value='"+su[i].sys_sa_id+"']").attr("selected",true);
	            		   //时间戳转换
	            		   var date = new Date(su[i].create_time);//时间戳为10位需*1000，时间戳为13位的话不需乘1000
	            	        Y = date.getFullYear() + '-';
	            	        M = (date.getMonth()+1 < 10 ? '0'+(date.getMonth()+1) : date.getMonth()+1) + '-';
	            	        D = date.getDate() + ' ';
	            	        var data2=Y+M+D;
	            	        
	            		   $("#selectDate").val(data2);  
	            	   }  
	               }
	   		 })  
        }
      
    </script>
</body>

</html>